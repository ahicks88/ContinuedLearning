More advanced matching and manipulation